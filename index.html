<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Lista de Fallas y Soluciones</title>
  <link rel="stylesheet" href="style.css">
</head>
<body style="background-image: PEGA_TU_IMAGEN_ACÁ;">

  <!-- Pantalla de carga -->
  <div id="preloader">
    <div class="loading-container">
      <div class="percentage" id="percentage">0%</div>
      <div class="progress-bar"><div class="progress-fill" id="progressFill"></div></div>
    </div>
  </div>

  <!-- Login -->
  <div id="loginContainer">
    <h1>Lista de Fallas y Soluciones</h1>
    <button id="loginBtn" onclick="login()">Acceder con Google</button>
  </div>

  <!-- Top bar -->
  <div class="top-bar">
    <span id="emailText"></span>
    <button id="logoutBtn" onclick="logout()" style="display:none;">Cerrar sesión</button>
  </div>

  <!-- Contenido principal -->
  <div id="appContent" style="display:none; flex-direction: column; align-items: center; width: 100%;">
    <h1>Lista de Fallas y Soluciones</h1>

    <div class="button-container" id="mainMenu">
      <button onclick="mostrarComoUsar()">Cómo usar</button>
      <button onclick="mostrarFallas()">Inicio - Ver fallas</button>
    </div>

    <div class="button-container" id="usoMenu" style="display:none;">
      <button onclick="volverA('main')">← Volver</button>
      <div class="response-box justificado">
        La lista está hecha de forma simple: le das a inicio, y seleccionás de toda la lista la falla que ves en tu equipo.
        Te van a salir las posibles fallas de un equipo para que las revises. Tocás en una, y te aparece un texto acerca de sus posibles soluciones.<br><br>
        Recordá que un componente dañado se cambia por uno nuevo, un componente desconectado se vuelve a conectar,
        un componente faltante se coloca, un componente o zona sucia o sulfatada se limpia.
        Y si dos o más componentes funcionan, el problema está en la conexión entre ambos (FPC).<br><br>
        En muchos casos, la lista te indicará dónde deberías revisar o el componente que podría generar la falla.
        Está en el técnico decidir qué hacer ;)
      </div>
    </div>

    <div class="button-container" id="fallasMenu" style="display:none;">
      <button onclick="showResponse('No enciende')">No enciende</button>
      <button onclick="showResponse('No tiene sonido')">No tiene sonido</button>
      <button onclick="showResponse('No puedo hacer llamadas')">No puedo hacer llamadas</button>
      <button onclick="showResponse('El teléfono se calienta')">El teléfono se calienta</button>
    </div>

    <div class="button-container" id="respuestas" style="display:none;"></div>

    <!-- Botón flotante home -->
    <button id="backBtn" class="back-button" onclick="goToHome()">
      <svg viewBox="0 0 24 24"><path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/></svg>
    </button>

    <!-- Footer -->
    <div class="footer">
      <img src="PEGA_TU_IMAGEN_ACÁ" alt="Logo">
      <div>Powered by Novacell Repairs</div>
      <div>By Lucas M. Tuillier</div>
    </div>
  </div>

  <!-- Scripts -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-app.js";
    import { getAuth, signInWithPopup, GoogleAuthProvider, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-auth.js";

    const firebaseConfig = {
      apiKey: "AIzaSyBt6OlcaDWbhx-ldI4l0a4kDPu8U1dm48c",
      authDomain: "login-de-lista-de-fallas.firebaseapp.com",
      projectId: "login-de-lista-de-fallas",
      storageBucket: "login-de-lista-de-fallas.firebasestorage.app",
      messagingSenderId: "632649294661",
      appId: "1:632649294661:web:9c6daa894931936c87142c"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth();
    const provider = new GoogleAuthProvider();

    window.login = () => signInWithPopup(auth, provider).catch(error => alert("Error al iniciar sesión: " + error.message));
    window.logout = () => signOut(auth);

    onAuthStateChanged(auth, user => {
      const loginContainer = document.getElementById("loginContainer");
      const appContent = document.getElementById("appContent");
      const emailText = document.getElementById("emailText");
      const logoutBtn = document.getElementById("logoutBtn");

      if (user) {
        loginContainer.style.display = "none";
        appContent.style.display = "flex";
        emailText.textContent = user.email;
        logoutBtn.style.display = "inline-block";
      } else {
        loginContainer.style.display = "flex";
        appContent.style.display = "none";
        logoutBtn.style.display = "none";
        emailText.textContent = "";
      }
    });
  </script>

  <script>
    const respuestasPorFalla = {
      "No enciende": [
        ["Revisar batería", "Medir batería para saber si funciona."],
        ["Botón de encendido", "Verificar si el botón funciona correctamente."],
        ["Placa base", "Posible falla de alimentación o cortocircuito."]
      ],
      "No tiene sonido": [
        ["Altavoz", "Probar el parlante con otro equipo."],
        ["Conectores", "Verificar si están sulfatados o desconectados."],
        ["Placa base", "Fallo en circuito de audio."]
      ],
      "No puedo hacer llamadas": [
        ["Estado del IMEI", "Verificar si el equipo fue dado de baja."],
        ["Chip", "Probar con otro chip o limpiar la bandeja."],
        ["Señal", "Revisar si toma señal correctamente."]
      ],
      "El teléfono se calienta": [
        ["Batería", "Puede estar defectuosa o vieja."],
        ["Apps en segundo plano", "Cerrar procesos que usen muchos recursos."],
        ["Mantenimiento", "Limpiar placa, cambiar pasta térmica."]
      ]
    };

    function mostrarComoUsar() {
      ocultarTodo();
      document.getElementById("usoMenu").style.display = "flex";
    }

    function mostrarFallas() {
      ocultarTodo();
      document.getElementById("fallasMenu").style.display = "flex";
    }

    function ocultarTodo() {
      document.getElementById("mainMenu").style.display = "none";
      document.getElementById("usoMenu").style.display = "none";
      document.getElementById("fallasMenu").style.display = "none";
      const respuestas = document.getElementById("respuestas");
      respuestas.style.display = "none";
      respuestas.innerHTML = "";
    }

    function volverA(seccion) {
      ocultarTodo();
      if (seccion === "main") {
        document.getElementById("mainMenu").style.display = "flex";
      } else if (seccion === "fallas") {
        document.getElementById("fallasMenu").style.display = "flex";
      }
    }

    function showResponse(falla) {
      ocultarTodo();
      const respuestas = document.getElementById("respuestas");
      respuestas.style.display = "flex";
      respuestas.innerHTML = `<button onclick="volverA('fallas')">← Volver</button><h2>${falla}</h2>`;
      respuestasPorFalla[falla].forEach(([titulo, descripcion]) => {
        const btn = document.createElement("button");
        btn.textContent = titulo;
        btn.onclick = () => {
          document.querySelectorAll(".response-box").forEach(e => e.remove());
          const box = document.createElement("div");
          box.className = "response-box";
          box.innerHTML = `➡ ${descripcion}`;
          respuestas.appendChild(box);
        };
        respuestas.appendChild(btn);
      });
    }

    function goToHome() {
      volverA("main");
    }

    // Animación de carga
    const preloader = document.getElementById("preloader");
    const fill = document.getElementById("progressFill");
    const percentText = document.getElementById("percentage");
    const smoothProgress = [1, 5, 9, 14, 20, 30, 40, 50, 60, 75, 88, 100];
    let index = 0;

    window.onload = () => {
      setTimeout(updateProgress, 300);
    };

    function updateProgress() {
      if (index < smoothProgress.length) {
        const value = smoothProgress[index];
        fill.style.width = value + "%";
        percentText.textContent = value + "%";
        index++;
        setTimeout(updateProgress, 150);
      } else {
        percentText.classList.add("flash");
        fill.classList.add("flash");
        setTimeout(() => {
          preloader.style.display = "none";
        }, 800);
      }
    }
  </script>
</body>
</html>
